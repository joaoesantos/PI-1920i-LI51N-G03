'use strict';
module.exports('initServer', function(){
    const http = require('http');

    //
    const webApi = require('./webapi/ciborg-web-api.js');
    const services = require('./services/ciborg-services.js')

    const server = http.createServer(processRequest);
    // config variables
    const config = require('./shared/config.js');
    server.listen(config.port);
    console.log("Listening so port:", config.port);
    //Register routes
    //webApi.get('/',services.home());
    webApi.get('/games', services.games.getAllGames);
    webApi.get('/games/{name}', services.games.searchByName);
    webApi.get('/games/{name}/groups/{id}', services.games.getGamesByGroupID);
    webApi.put('/games/{name}/groups/{id}', services.groups.updateGroup);
    webApi.post('/games/{name}/groups/{id}', services.groups.addGameToGroup);
    webApi.delete('/games/{name}/groups/{id}', services.groups.removeGameFromGroup);

    function processRequest(webApi); 
});



